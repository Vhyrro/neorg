--[[
--	HELPER FUNCTIONS FOR NEORG
--	This file contains some simple helper function improve quality of life
--]]

neorg.utils = {
    -- @Summary Requires a file from the context of the current module
    -- @Description Allows the module creator to require a file from within the module's cwd
    -- @Param  module (table) - the module creator's module
    -- @Param  filename (string) - a path to the file
    require = function(module, filename)
        return require("neorg.modules." .. module.name .. "." .. filename)
    end,

    -- @Summary Gets the current system username
    -- @Description An OS agnostic way of querying the current user
    get_username = function()
        local current_os = require("neorg.config").os_info

        if not current_os then
            return current_os
        end

        if current_os == "linux" or current_os == "mac" then
            return os.getenv("USER")
        elseif current_os == "windows" then
            return os.getenv("username")
        end

        return ""
    end,

    -- @Summary Returns a list of languages supported by Neorg
    -- @Description Returns an array of strings, the array being a list of languages that Neorg can inject
    -- @Param  values (boolean) - if set to true will return an array of strings, if false will return a key-value table
    get_language_list = function(values)
        local ret = {
            ["1c"] = {},
            ["4d"] = {},
            ["abnf"] = {},
            ["accesslog"] = {},
            ["ada"] = {},
            ["arduino"] = {},
            ["ino"] = {},
            ["armasm"] = {},
            ["arm"] = {},
            ["avrasm"] = {},
            ["actionscript"] = {},
            ["as"] = {},
            ["alan"] = {},
            ["i"] = {},
            ["ln"] = {},
            ["angelscript"] = {},
            ["asc"] = {},
            ["apache"] = {},
            ["apacheconf"] = {},
            ["applescript"] = {},
            ["osascript"] = {},
            ["arcade"] = {},
            ["asciidoc"] = {},
            ["adoc"] = {},
            ["aspectj"] = {},
            ["autohotkey"] = {},
            ["autoit"] = {},
            ["awk"] = {},
            ["mawk"] = {},
            ["bash"] = {},
            ["sh"] = {},
            ["basic"] = {},
            ["bbcode"] = {},
            ["blade"] = {},
            ["bnf"] = {},
            ["brainfuck"] = {},
            ["bf"] = {},
            ["csharp"] = {},
            ["cs"] = {},
            ["c"] = {},
            ["h"] = {},
            ["cpp"] = {},
            ["hpp"] = {},
            ["cal"] = {},
            ["cos"] = {},
            ["cls"] = {},
            ["cmake"] = {},
            ["cmake.in"] = {},
            ["coq"] = {},
            ["csp"] = {},
            ["css"] = {},
            ["capnproto"] = {},
            ["capnp"] = {},
            ["chaos"] = {},
            ["kaos"] = {},
            ["chapel"] = {},
            ["chpl"] = {},
            ["cisco"] = {},
            ["clojure"] = {},
            ["clj"] = {},
            ["coffeescript"] = {},
            ["coffee"] = {},
            ["cpc"] = {},
            ["crmsh"] = {},
            ["crm"] = {},
            ["crystal"] = {},
            ["cr"] = {},
            ["cypher"] = {},
            ["d"] = {},
            ["dns"] = {},
            ["zone"] = {},
            ["dos"] = {},
            ["bat"] = {},
            ["dart"] = {},
            ["dpr"] = {},
            ["dfm"] = {},
            ["diff"] = {},
            ["patch"] = {},
            ["django"] = {},
            ["jinja"] = {},
            ["dockerfile"] = {},
            ["docker"] = {},
            ["dsconfig"] = {},
            ["dts"] = {},
            ["dust"] = {},
            ["dst"] = {},
            ["dylan"] = {},
            ["ebnf"] = {},
            ["elixir"] = {},
            ["elm"] = {},
            ["erlang"] = {},
            ["erl"] = {},
            ["excel"] = {},
            ["xls"] = {},
            ["extempore"] = {},
            ["xtlang"] = {},
            ["fsharp"] = {},
            ["fs"] = {},
            ["fix"] = {},
            ["fortran"] = {},
            ["f90"] = {},
            ["gcode"] = {},
            ["nc"] = {},
            ["gams"] = {},
            ["gms"] = {},
            ["gauss"] = {},
            ["gss"] = {},
            ["godot"] = {},
            ["gdscript"] = {},
            ["gherkin"] = {},
            ["glimmer"] = {},
            ["gn"] = {},
            ["gni"] = {},
            ["go"] = {},
            ["golang"] = {},
            ["gf"] = {},
            ["golo"] = {},
            ["gololang"] = {},
            ["gradle"] = {},
            ["groovy"] = {},
            ["xml"] = {},
            ["html"] = {},
            ["http"] = {},
            ["https"] = {},
            ["haml"] = {},
            ["handlebars"] = {},
            ["haskell"] = {},
            ["hs"] = {},
            ["haxe"] = {},
            ["hx"] = {},
            ["hlsl"] = {},
            ["hy"] = {},
            ["hylang"] = {},
            ["ini"] = {},
            ["toml"] = {},
            ["inform7"] = {},
            ["i7"] = {},
            ["irpf90"] = {},
            ["json"] = {},
            ["java"] = {},
            ["jsp"] = {},
            ["javascript"] = {},
            ["js"] = {},
            ["jolie"] = {},
            ["iol"] = {},
            ["julia"] = {},
            ["julia-repl"] = {},
            ["kotlin"] = {},
            ["kt"] = {},
            ["tex"] = {},
            ["leaf"] = {},
            ["lean"] = {},
            ["lasso"] = {},
            ["less"] = {},
            ["ldif"] = {},
            ["lisp"] = {},
            ["livecodeserver"] = {},
            ["livescript"] = {},
            ["lua"] = {},
            ["makefile"] = {},
            ["mk"] = {},
            ["markdown"] = {},
            ["md"] = {},
            ["mathematica"] = {},
            ["mma"] = {},
            ["matlab"] = {},
            ["maxima"] = {},
            ["mel"] = {},
            ["mercury"] = {},
            ["mirc"] = {},
            ["mrc"] = {},
            ["mizar"] = {},
            ["mojolicious"] = {},
            ["monkey"] = {},
            ["moonscript"] = {},
            ["moon"] = {},
            ["n1ql"] = {},
            ["nsis"] = {},
            ["never"] = {},
            ["nginx"] = {},
            ["nginxconf"] = {},
            ["nim"] = {},
            ["nimrod"] = {},
            ["nix"] = {},
            ["ocl"] = {},
            ["ocaml"] = {},
            ["objectivec"] = {},
            ["mm"] = {},
            ["glsl"] = {},
            ["openscad"] = {},
            ["scad"] = {},
            ["ruleslanguage"] = {},
            ["oxygene"] = {},
            ["pf"] = {},
            ["pf.conf"] = {},
            ["php"] = {},
            ["papyrus"] = {},
            ["psc"] = {},
            ["parser3"] = {},
            ["perl"] = {},
            ["pl"] = {},
            ["plaintext"] = {},
            ["txt"] = {},
            ["pony"] = {},
            ["pgsql"] = {},
            ["postgres"] = {},
            ["powershell"] = {},
            ["ps"] = {},
            ["processing"] = {},
            ["prolog"] = {},
            ["properties"] = {},
            ["protobuf"] = {},
            ["puppet"] = {},
            ["pp"] = {},
            ["python"] = {},
            ["py"] = {},
            ["profile"] = {},
            ["python-repl"] = {},
            ["pycon"] = {},
            ["qsharp"] = {},
            ["k"] = {},
            ["kdb"] = {},
            ["qml"] = {},
            ["r"] = {},
            ["cshtml"] = {},
            ["razor"] = {},
            ["reasonml"] = {},
            ["re"] = {},
            ["redbol"] = {},
            ["rebol"] = {},
            ["rib"] = {},
            ["rsl"] = {},
            ["risc"] = {},
            ["riscript"] = {},
            ["graph"] = {},
            ["instances"] = {},
            ["robot"] = {},
            ["rf"] = {},
            ["rpm-specfile"] = {},
            ["rpm"] = {},
            ["ruby"] = {},
            ["rb"] = {},
            ["rust"] = {},
            ["rs"] = {},
            ["SAS"] = {},
            ["sas"] = {},
            ["scss"] = {},
            ["sql"] = {},
            ["p21"] = {},
            ["step"] = {},
            ["scala"] = {},
            ["scheme"] = {},
            ["scilab"] = {},
            ["sci"] = {},
            ["shexc"] = {},
            ["shell"] = {},
            ["console"] = {},
            ["smali"] = {},
            ["smalltalk"] = {},
            ["st"] = {},
            ["sml"] = {},
            ["solidity"] = {},
            ["sol"] = {},
            ["spl"] = {},
            ["stan"] = {},
            ["stanfuncs"] = {},
            ["stata"] = {},
            ["iecst"] = {},
            ["scl"] = {},
            ["stylus"] = {},
            ["styl"] = {},
            ["subunit"] = {},
            ["supercollider"] = {},
            ["sc"] = {},
            ["svelte"] = {},
            ["swift"] = {},
            ["tcl"] = {},
            ["tk"] = {},
            ["terraform"] = {},
            ["tf"] = {},
            ["tap"] = {},
            ["thrift"] = {},
            ["tp"] = {},
            ["tsql"] = {},
            ["twig"] = {},
            ["craftcms"] = {},
            ["typescript"] = {},
            ["ts"] = {},
            ["unicorn"] = {},
            ["vbnet"] = {},
            ["vb"] = {},
            ["vba"] = {},
            ["vbscript"] = {},
            ["vbs"] = {},
            ["vhdl"] = {},
            ["vala"] = {},
            ["verilog"] = {},
            ["v"] = {},
            ["vim"] = {},
            ["axapta"] = {},
            ["x++"] = {},
            ["x86asm"] = {},
            ["xl"] = {},
            ["tao"] = {},
            ["xquery"] = {},
            ["xpath"] = {},
            ["yml"] = {},
            ["yaml"] = {},
            ["zenscript"] = {},
            ["zs"] = {},
            ["zephir"] = {},
            ["zep"] = {},
        }

        if values then
            return vim.tbl_keys(ret)
        else
            return ret
        end
    end,

    get_language_shorthands = function(reverse_lookup)
        local langs = {
            ["bash"] = { "sh", "zsh" },
            ["c_sharp"] = { "csharp", "cs" },
            ["clojure"] = { "clj" },
            ["cmake"] = { "cmake.in" },
            ["commonlisp"] = { "cl" },
            ["cpp"] = { "hpp", "cc", "hh", "c++", "h++", "cxx", "hxx" },
            ["dockerfile"] = { "docker" },
            ["erlang"] = { "erl" },
            ["fennel"] = { "fnl" },
            ["fortran"] = { "f90", "f95" },
            ["go"] = { "golang" },
            ["godot"] = { "gdscript" },
            ["gomod"] = { "gm" },
            ["haskell"] = { "hs" },
            ["java"] = { "jsp" },
            ["javascript"] = { "js", "jsx" },
            ["julia"] = { "julia-repl" },
            ["kotlin"] = { "kt" },
            ["python"] = { "py", "gyp" },
            ["ruby"] = { "rb", "gemspec", "podspec", "thor", "irb" },
            ["rust"] = { "rs" },
            ["supercollider"] = { "sc" },
            ["typescript"] = { "ts" },
            ["verilog"] = { "v" },
            ["yaml"] = { "yml" },
        }

        return reverse_lookup and vim.tbl_add_reverse_lookup(langs) or langs
    end,

    get_package_path = function()
        -- Path to this source file, removing the leading '@'
        local source = string.sub(debug.getinfo(1, "S").source, 2)

        -- Path to the package root
        return vim.fn.fnamemodify(source, ":p:h:h:h:h")
    end,
}

return neorg.utils
